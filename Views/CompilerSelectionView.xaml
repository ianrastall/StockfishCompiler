<UserControl x:Class="StockfishCompiler.Views.CompilerSelectionView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
    <ScrollViewer>
        <StackPanel Margin="20">
            <GroupBox Header="System Information" Style="{StaticResource DarkGroupBox}">
                <StackPanel>
                    <TextBlock Text="{Binding SystemInfo}" Style="{StaticResource InfoText}" Margin="0,5"/>
                    <StackPanel Orientation="Horizontal">
                        <Button Content="Detect Compilers" 
                                Command="{Binding DetectCompilersCommand}" 
                                Style="{StaticResource DarkButton}" 
                                HorizontalAlignment="Left"
                                IsEnabled="{Binding IsDetectingCompilers, Converter={StaticResource InverseBooleanConverter}}"/>
                        <Button Content="Download &amp; Install MSYS2 (GCC)"
                                Click="InstallCompiler_Click"
                                Style="{StaticResource DarkButton}"
                                HorizontalAlignment="Left"
                                IsEnabled="{Binding IsDetectingCompilers, Converter={StaticResource InverseBooleanConverter}}"/>
                    </StackPanel>
                    <TextBlock Text="If no compiler is found, use the installer to grab MSYS2 + GCC, then re-run detection."
                               Style="{StaticResource DescriptionText}"
                               Margin="0,5,0,0"/>
                    <TextBlock Text="Detecting compilers..." 
                               Style="{StaticResource InfoText}" 
                               Margin="10,5" 
                               Visibility="{Binding IsDetectingCompilers, Converter={StaticResource BoolToVisibilityConverter}}"/>
                    <TextBlock Text="{Binding DetectionDetails}"
                               Style="{StaticResource DescriptionText}"
                               Margin="0,5,0,0"
                               TextWrapping="Wrap"/>
                </StackPanel>
            </GroupBox>

            <GroupBox Header="Compiler Selection" Style="{StaticResource DarkGroupBox}">
                <StackPanel>
                    <TextBlock Text="Select a compiler from the dropdown:" 
                               Style="{StaticResource DescriptionText}" 
                               Margin="0,0,0,5"/>
                    
                    <ComboBox ItemsSource="{Binding AvailableCompilers}"
                              SelectedItem="{Binding SelectedCompiler}"
                              DisplayMemberPath="DisplayName"
                              Style="{StaticResource DarkComboBox}" 
                              Height="35" 
                              Margin="0,5"
                              IsEnabled="{Binding IsDetectingCompilers, Converter={StaticResource InverseBooleanConverter}}"/>
                    
                    <StackPanel Orientation="Horizontal" Margin="0,10,0,5" Visibility="{Binding SelectedCompiler, Converter={StaticResource NullToVisibilityConverter}}">
                        <TextBlock Text="Compiler Path:" Style="{StaticResource LabelText}"/>
                        <TextBlock Text="{Binding SelectedCompiler.Path}" Style="{StaticResource ValueText}"/>
                    </StackPanel>
                    
                    <StackPanel Orientation="Horizontal" Margin="0,5" Visibility="{Binding SelectedCompiler, Converter={StaticResource NullToVisibilityConverter}}">
                        <TextBlock Text="Version:" Style="{StaticResource LabelText}"/>
                        <TextBlock Text="{Binding SelectedCompiler.Version}" Style="{StaticResource ValueText}"/>
                    </StackPanel>
                </StackPanel>
            </GroupBox>

            <GroupBox Header="Architecture Selection" Style="{StaticResource DarkGroupBox}">
                <StackPanel>
                    <TextBlock Text="CPU architecture determines optimal instruction sets for performance." 
                               Style="{StaticResource DescriptionText}" 
                               Margin="0,0,0,10"/>
                    
                    <Button Content="Detect Optimal Architecture" 
                            Command="{Binding DetectArchitectureCommand}" 
                            Style="{StaticResource DarkButton}" 
                            HorizontalAlignment="Left"/>
                    
                    <TextBlock Text="Detecting CPU features..." 
                               Style="{StaticResource InfoText}" 
                               Margin="10,5" 
                               Visibility="{Binding IsDetectingArchitecture, Converter={StaticResource BoolToVisibilityConverter}}"/>
                    
                    <ComboBox ItemsSource="{Binding AvailableArchitectures}"
                              SelectedItem="{Binding SelectedArchitecture}"
                              DisplayMemberPath="Name"
                              Style="{StaticResource DarkComboBox}" 
                              Height="35" 
                              Margin="0,10,0,5"
                              IsEnabled="{Binding IsDetectingArchitecture, Converter={StaticResource InverseBooleanConverter}}"/>
                    
                    <TextBlock Text="{Binding SelectedArchitecture.Description}" 
                               Style="{StaticResource DescriptionText}" 
                               Margin="0,5,0,0"
                               Visibility="{Binding SelectedArchitecture, Converter={StaticResource NullToVisibilityConverter}}"/>
                </StackPanel>
            </GroupBox>
        </StackPanel>
    </ScrollViewer>
</UserControl>
