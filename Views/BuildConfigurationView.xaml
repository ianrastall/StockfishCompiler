<UserControl x:Class="StockfishCompiler.Views.BuildConfigurationView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
    <ScrollViewer>
        <StackPanel Margin="20">
            <GroupBox Header="Stockfish Version" Style="{StaticResource DarkGroupBox}">
                <StackPanel>
                    <TextBlock Text="Select which version of Stockfish to compile:" 
                               Style="{StaticResource DescriptionText}" 
                               Margin="0,0,0,5"/>
                    
                    <ComboBox ItemsSource="{Binding AvailableVersions}"
                              SelectedItem="{Binding SelectedVersionInfo}"
                              DisplayMemberPath="DisplayName"
                              Style="{StaticResource DarkComboBox}" 
                              Height="35" 
                              Margin="0,5"/>
                    
                    <!-- Version Description -->
                    <TextBlock Text="{Binding SelectedVersionInfo.Description}" 
                               Style="{StaticResource DescriptionText}" 
                               Margin="0,5,0,0"
                               Visibility="{Binding SelectedVersionInfo, Converter={StaticResource NullToVisibilityConverter}}"/>
                    
                    <!-- Technical Requirements Info -->
                    <StackPanel Orientation="Horizontal" Margin="0,5,0,0"
                                Visibility="{Binding SelectedVersionInfo, Converter={StaticResource NullToVisibilityConverter}}">
                        <TextBlock Style="{StaticResource DescriptionText}" Foreground="{StaticResource TextSecondaryBrush}">
                            <Run Text="Requirements: "/>
                            <Run Text="{Binding SelectedVersionInfo.MinimumCppStandard, FallbackValue=C++11}"/>
                            <Run Text=" | Neural Network: "/>
                            <Run Text="{Binding SelectedVersionInfo.NnueRequirement, FallbackValue=Unknown}"/>
                        </TextBlock>
                    </StackPanel>
                    
                    <!-- Compatibility Notes -->
                    <TextBlock Text="{Binding SelectedVersionInfo.CompatibilityNotes}" 
                               Style="{StaticResource DescriptionText}"
                               Foreground="{StaticResource WarningBrush}"
                               Margin="0,5,0,0"
                               TextWrapping="Wrap"
                               Visibility="{Binding SelectedVersionInfo.CompatibilityNotes, Converter={StaticResource NullToVisibilityConverter}}"/>
                    
                    <!-- Strong Incompatibility Warning -->
                    <Border Background="#33F56565" 
                            BorderBrush="{StaticResource ErrorBrush}" 
                            BorderThickness="1"
                            CornerRadius="4"
                            Padding="10"
                            Margin="0,10,0,0"
                            Visibility="{Binding SelectedVersionInfo.IsCompatible, Converter={StaticResource InverseBooleanConverter}, FallbackValue=Collapsed, TargetNullValue=Collapsed}">
                        <StackPanel>
                            <TextBlock Text="?? BUILD COMPATIBILITY WARNING" 
                                       FontWeight="Bold"
                                       Foreground="{StaticResource ErrorBrush}"
                                       Margin="0,0,0,5"/>
                            <TextBlock Style="{StaticResource DescriptionText}"
                                       Foreground="{StaticResource TextPrimaryBrush}"
                                       TextWrapping="Wrap">
                                This version predates the build system and neural network architecture that this tool is based on (Stockfish 17.1). 
                                Compilation will likely fail or produce non-functional binaries. Consider using a newer version or compiling manually.
                            </TextBlock>
                        </StackPanel>
                    </Border>
                </StackPanel>
            </GroupBox>
            
            <GroupBox Header="Build Options" Style="{StaticResource DarkGroupBox}">
                <StackPanel>
                    <CheckBox Content="Download neural network (NNUE)" 
                              IsChecked="{Binding DownloadNetwork}" 
                              Style="{StaticResource DarkCheckBox}" 
                              Margin="0,5"/>
                    <TextBlock Text="Note: Neural network download is required for the selected version" 
                               Style="{StaticResource DescriptionText}"
                               Foreground="{StaticResource AccentBrush}"
                               Margin="25,0,0,5"
                               TextWrapping="Wrap"
                               Visibility="{Binding SelectedVersionInfo, Converter={StaticResource NullToVisibilityConverter}}"/>
                    
                    <CheckBox Content="Strip executable (reduce file size)" IsChecked="{Binding StripExecutable}" Style="{StaticResource DarkCheckBox}" Margin="0,5"/>
                    <CheckBox Content="Use PGO (profile-guided optimization)" IsChecked="{Binding EnablePgo}" Style="{StaticResource DarkCheckBox}" Margin="0,5"/>
                    
                    <StackPanel Orientation="Horizontal" Margin="0,10,0,5">
                        <TextBlock Text="Parallel jobs:" Style="{StaticResource LabelText}" VerticalAlignment="Center"/>
                        <TextBox Width="60" Text="{Binding ParallelJobs}" Style="{StaticResource DarkTextBox}"/>
                        <TextBlock Text="(CPU cores)" Style="{StaticResource InfoText}" Margin="10,0" VerticalAlignment="Center"/>
                    </StackPanel>
                </StackPanel>
            </GroupBox>

            <GroupBox Header="Output Directory" Style="{StaticResource DarkGroupBox}">
                <StackPanel>
                    <TextBox Text="{Binding OutputDirectory}" Style="{StaticResource DarkTextBox}" Margin="0,5"/>
                    <TextBlock Text="The compiled Stockfish executable will be saved here." Style="{StaticResource DescriptionText}" Margin="0,5,0,0"/>
                </StackPanel>
            </GroupBox>
        </StackPanel>
    </ScrollViewer>
</UserControl>
